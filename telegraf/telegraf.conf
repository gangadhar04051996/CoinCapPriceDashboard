# Global tags can be specified here in key="value" format.
[global_tags]

# Configuration for telegraf agent
[agent]
  interval = "10s"
  round_interval = true
  metric_batch_size = 1000
  metric_buffer_limit = 10000
  collection_jitter = "0s"
  flush_interval = "10s"
  flush_jitter = "0s"
  precision = "1s"
  hostname = "influxdb"
  omit_hostname = false

# Get Bitcoin market price data from CoinCap API
[[inputs.http]]
  ## URL for the CoinCap API to fetch Bitcoin data
  urls = ["https://api.coincap.io/v2/assets"]

  ## Define method and headers
  method = "GET"
  headers = {"Authorization" = "Bearer 2b9281b0-5c94-4017-944b-09681f69ecd9"}
  
  ## Data format to read.
  ## In this case, set it to JSON since the response will be in JSON format.
  data_format = "json"
  ## Specify JSON query to fetch the specific field for price data
  json_query = "data.priceUsd"
  tag_keys = [
    "data.symbol"
  ]
  ## Define the name of the measurement to store the data
  name_override = "marketpricedata"

# Write the data to InfluxDB 2.0
[[outputs.influxdb_v2]]
  ## The URLs of the InfluxDB cluster nodes.
  urls = ["http://influxdb:8086"]
  ## Token for authentication.
  token = "iUjnOtambYUcVsZv1OEgJabl_hTjzaJNsoZYmi4y4CP73FZ2uI4KzDRDHzj7tXNDe4zhJPyDbdO7NteN7WhjVQ=="
  organization = "ORG_NAME"
  bucket = "bitcoinprice"
  
